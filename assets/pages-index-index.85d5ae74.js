import{n as e,o as t,c as s,a,w as l,F as i,i as c,b as d,d as n,e as f,r,f as u,t as o,g as m,h as _,j as y,k as h}from"./index-b3f07714.js";import{_ as k,a as g,b as p,c as b}from"./star2.46b45908.js";import{_ as C}from"./plugin-vue_export-helper.1b428a4d.js";const R=C({components:{},inject:["getFeedbackList"],data:()=>({tabs:["最新","吐槽","推荐"],currentTab:"最新",regionCounts:{},selectedCity:null,todayVisits:"0",yesterdayVisits:"0",totalVisits:"0"}),computed:{feedbackList(){return this.getFeedbackList()},filteredItems(){let e=[];switch(this.currentTab){case"吐槽":e=this.feedbackList.filter((e=>"吐槽"===e.fields.Remarks));break;case"推荐":e=this.feedbackList.filter((e=>"推荐"===e.fields.Remarks));break;default:e=this.feedbackList}return this.selectedCity&&(e=e.filter((e=>e.fields.Region===this.selectedCity))),e},citiesCount(){const e={};return this.feedbackList.forEach((t=>{const s=t.fields.Region;e[s]?e[s]+=1:e[s]=1})),e},feedbackList(){let e=this.getFeedbackList();return e.sort(((e,t)=>t.fields.Date-e.fields.Date)),e}},methods:{switchTab(e){this.currentTab=e,this.$emit("tab-switched",e)},handleTabSwitched(e){this.currentTab=e},formatDate:e=>new Date(e).toLocaleDateString(),getResponseTypeText:e=>({opttTdVxtc:"反驳",optId1TKD6:"解释",optId1TKD7:"辟谣"}[e]||"未知回应类型"),viewDetail(t){e({url:`/pages/detail/detail?id=${t}`})},selectCity(e){this.selectedCity=e}},mounted(){const e=setInterval((()=>{const t=document.querySelector(".la-widget.la-data-widget__container");if(t){clearInterval(e);const s=t.querySelectorAll('span[style*="font-weight: bold !important;"]');s.length>=3&&(this.todayVisits=s[0].textContent,this.yesterdayVisits=s[1].textContent,this.totalVisits=s[2].textContent)}}),1e3)}},[["render",function(e,C,R,T,w,D){const I=_,V=c,x=y,v=h;return t(),s(i,null,[a(V,{class:"header"},{default:l((()=>[a(V,{class:"logo"},{default:l((()=>[a(I,{class:"logoimg",src:"/dengta/assets/logo-47bb4fee.png",mode:"heightFix"})])),_:1}),a(V,{class:"search"},{default:l((()=>[d("uni-view",{class:"link"},[a(v,{url:"/pages/link/link?url=https://kaqtunnycfp.feishu.cn/share/base/form/shrcnCwQww4DFVFNGgmzHItOQ5f"},{default:l((()=>[a(x,{class:"fankui"},{default:l((()=>[n("网站反馈")])),_:1})])),_:1})])])),_:1})])),_:1}),a(V,{class:"container"},{default:l((()=>[a(V,{class:"textTOP"},{default:l((()=>[a(x,null,{default:l((()=>[n("试运行...提交的数据不会及时刷新，每小时集中更新一次。")])),_:1})])),_:1}),a(V,{class:"linkGroup"},{default:l((()=>[a(v,{url:"/pages/link/link?url=https://kaqtunnycfp.feishu.cn/share/base/form/shrcnucYNxp6AfaRtOSS5ptdUyf"},{default:l((()=>[a(V,{class:"tucaoTuijian formBut"},{default:l((()=>[n(" 吐槽&推荐 ")])),_:1})])),_:1}),a(v,{url:"/pages/link/link?url=https://kaqtunnycfp.feishu.cn/share/base/form/shrcnOIbet5sZA1QqVhFyRAl9Dc"},{default:l((()=>[a(V,{class:"huiying formBut"},{default:l((()=>[n(" 被吐槽回应 ")])),_:1})])),_:1})])),_:1}),a(V,{class:"RegionList"},{default:l((()=>[a(V,{class:"city-list"},{default:l((()=>[a(V,{class:f(["city-item",{"active-city":null===w.selectedCity}]),onClick:C[0]||(C[0]=e=>D.selectCity(null))},{default:l((()=>[a(x,{class:"city-name"},{default:l((()=>[n("全部")])),_:1})])),_:1},8,["class"]),(t(!0),s(i,null,r(D.citiesCount,((e,s)=>(t(),u(V,{class:f(["city-item",{"active-city":s===w.selectedCity}]),key:s,onClick:e=>D.selectCity(s)},{default:l((()=>[a(x,{class:"city-name"},{default:l((()=>[n("#"+o(s),1),a(x,{class:"city-count"},{default:l((()=>[n(o(e),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),a(V,{class:"top-switcher"},{default:l((()=>[a(x,null,{default:l((()=>[(t(!0),s(i,null,r(w.tabs,((e,s)=>(t(),u(x,{class:f(["button",{active:w.currentTab===e}]),key:s,onClick:t=>D.switchTab(e)},{default:l((()=>[n(o(e),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),a(V,{class:"list"},{default:l((()=>[(t(!0),s(i,null,r(D.filteredItems,((e,c)=>(t(),u(V,{class:"list-item",key:c,onClick:t=>D.viewDetail(e.fields.ID)},{default:l((()=>[a(V,{class:"itemHeader"},{default:l((()=>[a(V,{class:"itemTitle"},{default:l((()=>["吐槽"==e.fields.Remarks?(t(),s("img",{key:0,class:"TitleImg",src:k})):m("",!0),"推荐"==e.fields.Remarks?(t(),s("img",{key:1,class:"TitleImg",src:g})):m("",!0),a(x,{class:"CompanyOrPartner"},{default:l((()=>[n(o(e.fields.CompanyOrPartner),1)])),_:2},1024)])),_:2},1024),a(x,{class:"Region"},{default:l((()=>[n("#"+o(e.fields.Region),1)])),_:2},1024)])),_:2},1024),a(V,{class:"Remarks"},{default:l((()=>[a(x,{class:"rating"},{default:l((()=>[(t(!0),s(i,null,r(parseInt(e.fields.Rating),(e=>(t(),u(x,{class:"star",key:"filled-"+e},{default:l((()=>[d("img",{class:"starImg",src:p})])),_:2},1024)))),128)),(t(!0),s(i,null,r(5-parseInt(e.fields.Rating),(e=>(t(),u(x,{class:"star",key:"empty-"+e},{default:l((()=>[d("img",{class:"starImg",src:b})])),_:2},1024)))),128))])),_:2},1024),a(V,{class:"itemRight"},{default:l((()=>[a(x,{class:"EmploymentType"},{default:l((()=>[n(o(e.fields.Remarks)+"人："+o(e.fields.EmploymentType)+",",1)])),_:2},1024),a(x,{class:"Duration"},{default:l((()=>[n(o(e.fields.Duration),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),a(V,{class:"Reason"},{default:l((()=>[n(o(e.fields.Reason),1)])),_:2},1024),e.fields.Feedback&&e.fields.Feedback.length>0?(t(),u(V,{key:0,class:"response"},{default:l((()=>[n(o(e.fields.ReviewerPosition[0].text)+" 回应 >> [点击查看] ",1)])),_:2},1024)):m("",!0),a(V,{class:"itemFooter"},{default:l((()=>[a(x,{class:"ID"},{default:l((()=>[n(o(e.fields.Remarks)+"编号："+o(e.fields.ID),1)])),_:2},1024),a(x,{class:"dateTime"},{default:l((()=>[n(o(D.formatDate(e.fields.Date)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),a(V,{class:"footer"},{default:l((()=>[a(V,{class:"",style:{"padding-bottom":"20px"}},{default:l((()=>[n(" -----已到最底了----- ")])),_:1}),a(V,{class:""},{default:l((()=>[n(" 网络不是法外之地，请谨言慎行。 ")])),_:1}),a(V,{class:""},{default:l((()=>[n(" ©影视灯塔Beta ")])),_:1}),"0"!==w.totalVisits&&w.totalVisits?(t(),u(V,{key:0,class:""},{default:l((()=>[a(x,{class:""},{default:l((()=>[n("今日访问量: "+o(w.todayVisits)+" |",1)])),_:1}),a(x,{class:""},{default:l((()=>[n("昨日访问量: "+o(w.yesterdayVisits)+" |",1)])),_:1}),a(x,{class:""},{default:l((()=>[n("总访问量: "+o(w.totalVisits),1)])),_:1})])),_:1})):m("",!0)])),_:1})],64)}],["__scopeId","data-v-fb48347a"]]);export{R as default};
